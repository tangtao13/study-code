<!--
 * @Author: myname
 * @Date: 2021-05-27 08:35:23
 * @LastEditors: Do not edit
 * @LastEditTime: 2021-05-27 17:06:20
-->

### DOM 概述

1. DOM

    - DOM 是 JavaScript 操作网页的接口，全称为“文档对象模型”（Document Object Model）。
    - 作用是将网页转为一个 JavaScript 对象，从而用脚本进行各种操作。
    - DOM 只是一个接口规范，可以用各种语言实现。
    - DOM 树

2. 节点

    - DOM 的最小组成单位（node）
    - 文档的树形结构（DOM 树），就是有不同类型的节点组成。
    - 节点的类型：
        - Document: 整个文档树的顶层节点
        - DocumentType: doctype 标签（比如`<!DOCTYPE HTML>`）
        - Element: 网页中的各种 HTML 标签（比如`<body>、<a>`）
        - Attr: 网页元素的属性（比如 class="right"）
        - Text: 标签之间或标签包含的文本
        - Comment: 注释
        - DocumentFragment: 文档的片段
    - 浏览器提供一个原生的节点对象 Node,上面这 7 中节点都继承了 Node，因此具有一些共同的属性和方法。

3. 节点树

    - 一个文档的所有节点，按照所在的层级，可以抽象成一种树状结构。（DOM 树）
    - 浏览器原生提供 document 节点，代表整个文档
    - 文档的第一层有两个节点，第一个是文档类型节点，第二个是 HTML 网页的顶层容器标签`<html>`。后者构成了树结  
      构的根节点 （root node），其他 HTML 标签节点都是它的下级节点。
    - 除了根节点，其他节点都有三种层级关系：
        - 父节点关系（parentNode）: 直接的那个上级节点
        - 子节点关系（childNodes）: 直接的下级节点
        - 同级节点关系（sibling）: 拥有同一个父节点的节点
    - DOM 提供操作接口，用来获取这三种关系的节点。
        - 子节点接口：firstChild,lastChild
        - 同级节点接口: nextSibling,previousSibling

### Node 节点

> 所有的 DOM 节点对象都集成了 Node 接口，拥有一些共同的属性和方法。这是 DOM 操作的基础。

###### 目录

1.  属性

    -   Node.prototype.nodeType  
        返回一个整数值，表示节点的类型。  
        不同节点的 nodeType 属性值和对应的常量如下：

            - document: 9, 对应常量 Node.DOCUMENT_NODE
            - element: 1, 对应常量 Node.ELEMENT_NODE
            - attr: 2, 对应常量 Node.ATTRIBUTE_NODE
            - text: 3, 对应常量 Node.TEXT_NODE
            - DocumentFragment: 11, 对应常量 Node.DOCUMENT_FRAGMENT_NODE
            - DocumentType: 10, 对应常量 Node.DOCUMENT_TYPE_NODE
            - Comment: 8, 对应常量 Node.COMMENT_NODE

    -   Node.prototype.nodeName  
        返回节点的名字
    -   Node.prototype.nodeValue  
        返回一个字符串，表示当前节点本身的文本值，该属性可读写。
    -   Node.prototype.textContent  
        返回当前节点和它的所有后代节点的文本内容。  
        要读取整个文档的内容，可以使用 document.documentElement.textContent
    -   Node.prototype.baseURL  
        返回一个字符串，表示当前网页的绝对路径。浏览器根据这个属性，计算网页上的相对路径的 URL。该属性为只读。
    -   Node.prototype.ownerDocument  
        返回当前节点所在的顶层文档对象，即 document 对象。  
        document 对象本身的 ownerDocument 属性，返回 null。
    -   Node.prototype.nextSibling
    -   Node.prototype.previousSibling
    -   Node.prototype.parentNode
    -   Node.prototype.parentElement
    -   Node.prototype.firstChild,Node.prototype.lastChild
    -   Node.prototype.childNodes
    -   Node.prototype.isConnected  
        返回一个布尔值，表示当前节点是否在文档之中。

2.  方法
    -   Node.prototype.appendChild()
    -   Node.prototype.hasChildNodes()
    -   Node.prototype.cloneNode()
    -   Node.prototype.insertBefore()
    -   Node.prototype.removeChild()
    -   Node.prototype.replaceChild()
    -   Node.prototype.contains()
    -   Node.prototype.compareDocumentPostion()
    -   Node.prototype.isEqualNode()
    -   Node.prototype.isSameNode()
    -   Node.prototype.normalize()
    -   Node.prototype.getRootNode()

### NodeList 接口，HTMLCollection 接口，ParentNode 接口，ChildNode 接口

###### 目录

1.  NodeList 接口

    -   概述

        -   NodeList 实例是一个类似数组的对象，它的成员是节点对象。通过以下方法可以得到 NodeList 实例。

            -   Node.childNodes
            -   document.querySelectorAll()等节点搜索方法

        -   目前，只有 Node.childNodes 返回的是一个动态集合，其他的 NodeList 都是静态集合。

    -   NodeList.prototype.length
    -   NodeList.prototype.forEach()
    -   NodeList.prototype.item()
        -   接受一个整数值作为参数，表示成员的位置，返回该位置上的成员。
        -   有类似数组的对象，都可以使用方括号运算符取出成员。一般情况下，都是使用方括号运算符，而不使用 item 方法。
    -   NodeList.prototype.keys()，NodeList.prototype.values()，NodeList.prototype.entries()

2.  HTMLCollection 接口

    -   概述

        -   是一个节点对象的集合，只能包含元素节点（element），不能包含其他类型的节点。
        -   HTMLCollection 的返回值是一个类似数组的对象，但是没有 forEach 方法，只能使用 for 循环遍历。
        -   返回 HTMLCollection 实例的，主要是一些 Document 对象的集合属性，比如
            document.links、document.forms、document.images 等。
        -   HTMLCollection 实例都是动态集合，节点的变化会实时反映在集合中。

    -   HTMLCollection.prototype.length
    -   HTMLCollection.prototype.item()
    -   HTMLCollection.prototype.namedItem()
        -   参数是一个字符串，表示 id 属性或 name 属性的值，返回对应的元素节点。如果没有对应的节点，则返回 null。

3.  ParentNode 接口

    -   ParentNode.children
    -   ParentNode.firstElementChild
    -   ParentNode.lastElementChild
    -   ParentNode.childElementCount
    -   ParentNode.append()，ParentNode.prepend()

4.  ChildNode 接口

    -   ChildNode.remove()
    -   ChildNode.before()，ChildNode.after()
    -   ChildNode.replaceWith()

5.  Document 节点

    -   概述
    -   属性

        -   快捷方式属性

            -   document.defaultView  
                 返回 document 对象所属的 window 对象。如果当前文档不属于 window 对象，该属性返回 null。
            -   document.doctype
            -   document.documentElement  
                 返回当前文档的根元素节点（root）
            -   document.body，document.head
            -   document.scrollingElement  
                 返回文档的滚动元素
            -   document.activeElement  
                 返回获得当前焦点（focus）的 DOM 元素。
            -   document.fullscreenElement

        -   节点集合属性

            下属性返回一个 HTMLCollection 实例，表示文档内部特定元素的集合。这些集合都是动态的，  
            原节点有任何变化，立刻会反映在集合中。除了 document.styleSheets。

            -   document.links  
                 返回当前文档所有设定了 href 属性的`<a>`及`<area>`节点
            -   document.forms  
                 返回所有`<form>`表单节点。  
                 除了使用位置序号，id 属性和 name 属性也可以用来引用表单。
            -   document.images  
                 返回页面所有`<img>`图片节点
            -   document.embeds，document.plugins  
                 返回所有`<embed>`节点
            -   document.scripts  
                 返回所有`<script>`节点。
            -   document.styleSheets  
                 回文档内嵌或引入的样式表集合

        -   文档静态信息属性

            -   document.documentURI，document.URL  
                 属性都返回一个字符串，表示当前文档的网址。不同之处是它们继承自不同的接口，documentURI  
                 继承自 Document 接口，可用于所有文档；URL 继承自 HTMLDocument 接口，只能用于 HTML 文档。 如果文档的锚点
                （#anchor）变化，这两个属性都会跟着变化
            -   document.domain  
                 返回当前文档的域名，不包含协议和端口
            -   document.location ☆  
                Location 对象是浏览器提供的原生对象，提供 URL 相关的信息和操作方法。通过  
                window.location 和 document.location 属性，可以拿到这个对象。
            -   document.lastModified  
                 返回一个字符串，表示当前文档最后修改的时间。不同浏览器的返回值，日期格式是不一样的。
            -   document.title  
                 返回当前文档的标题
            -   document.characterSet  
                 回当前文档的编码，比如 UTF-8、ISO-8859-1 等等
            -   document.referrer  
                 返回一个字符串，表示当前文档的访问者来自哪里。
            -   document.dir  
                 返回一个字符串，表示文字方向。
            -   document.compatMode  
                 返回浏览器处理文档的模式，可能的值为 BackCompat（向后兼容模式）和 CSS1Compat（严格模式）

        -   文档状态属性

            -   document.hidden  
                 返回一个布尔值，表示当前页面是否可见。如果窗口最小化、浏览器切换了 Tab，都会导致导致  
                 页面不可见，使得 document.hidden 返回 true.这个属性是 Page Visibility API 引入的，  
                 一般都是配合这个 API 使用.
            -   document.visibilityState  
                返回文档的可见状态:

                -   visible：页面可见。注意，页面可能是部分可见，即不是焦点窗口，前面被其他窗口部分挡住了.
                -   hidden：页面不可见，有可能窗口最小化，或者浏览器切换到了另一个 Tab。
                -   prerender：页面处于正在渲染状态，对于用户来说，该页面不可见。
                -   unloaded：页面从内存里面卸载了。

            -   document.readyState  
                 返回当前文档的状态，共有三种可能的值。
                -   loading：加载 HTML 代码阶段（尚未完成解析）
                -   interactive：加载外部资源阶段
                -   complete：加载完成

        -   document.cookie  
            用来操作浏览器 Cookie
        -   document.designMode  
            属性控制当前文档是否可编辑  
            该属性只有两个值 on 和 off，默认值为 off。一旦设为 on，用户就可以编辑整个文档的内容
        -   document.currentScript  
            只用在`<script>`元素的内嵌脚本或加载的外部脚本之中，返回当前脚本所在的那个 DOM 节点，  
            即`<script>`元素的 DOM 节点。
        -   document.implementation  
            返回一个 DOMImplementation 对象。该对象有三个方法，主要用于创建独立于当前文档的新的  
            Document 对象：
            -   DOMImplementation.createDocument()：创建一个 XML 文档。
            -   DOMImplementation.createHTMLDocument()：创建一个 HTML 文档。
            -   DOMImplementation.createDocumentType()：创建一个 DocumentType 对象。

    -   方法

        -   document.open()，document.close()  
             document.open 方法清除当前文档所有内容，使得文档处于可写状态，供 document.write 方法写入内容。  
             document.close 方法用来关闭 document.open()打开的文档。
        -   document.write()，document.writeln()  
             document.write 方法用于向当前文档写入内容。  
             document.writeln 方法与 write 方法完全一致，除了会在输出内容的尾部添加换行符。
        -   document.querySelector()，document.querySelectorAll()  
             document.querySelectorAll() -》 NodeList 实例
        -   document.getElementsByTagName() -> HTMLCollection 实例
        -   document.getElementsByClassName() -> HTMLCollection 实例
        -   document.getElementsByName() -> NodeList 实例
        -   document.getElementById()
        -   document.elementFromPoint()  
             返回位于页面指定位置最上层的元素节点。
        -   document.elementsFromPoint()  
             返回一个数组，成员是位于指定坐标（相对于视口）的所有元素
        -   document.createElement()  
             方法用来生成元素节点，并返回该节点。  
             document.createElement 的参数可以是自定义的标签名。
        -   document.createTextNode()  
             用来生成文本节点（Text 实例），并返回该节点。它的参数是文本节点的内容
        -   document.createAttribute()  
             生成一个新的属性节点（Attr 实例），并返回它。
        -   document.createComment()
        -   document.createDocumentFragment()  
             生成一个空的文档片段对象（DocumentFragment 实例）。
        -   document.createEvent()  
             生成一个事件对象（Event 实例），该对象可以被 element.dispatchEvent 方法使用，触发指定事件。
        -   document.addEventListener()，document.removeEventListener()，document.dispatchEvent()
        -   document.hasFocus()
        -   document.adoptNode()，document.importNode()
        -   document.createNodeIterator()
        -   document.createTreeWalker()
        -   document.execCommand()，document.queryCommandSupported()，document.queryCommandEnabled()

            ```javascript
            // HTML 代码为
            // <input type="button" value="Copy" onclick="doCopy()">

            function doCopy() {
                // 浏览器是否支持 copy 命令（选中内容复制到剪贴板）
                if (document.queryCommandSupported('copy')) {
                    copyText('你好');
                } else {
                    console.log('浏览器不支持');
                }
            }

            function copyText(text) {
                var input = document.createElement('textarea');
                document.body.appendChild(input);
                input.value = text;
                input.focus();
                input.select();

                // 当前是否有选中文字
                if (document.queryCommandEnabled('copy')) {
                    var success = document.execCommand('copy');
                    input.remove();
                    console.log('Copy Ok');
                } else {
                    console.log('queryCommandEnabled is false');
                }
            }
            ```

        -   document.getSelection()

6.  Element 节点

    -   简介  
        Element 节点对象对应网页的 HTML 元素。每一个 HTML 元素，在 DOM 树上都会转化成一个 Element  
        节点对象（以下简 称元素节点）。元素节点的 nodeType 属性都是 1。
    -   实例属性

        -   元素特性的相关属性
            -   Element.id 返回指定元素的 id 属性，该属性可读写。
            -   Element.tagName 返回指定元素的大写标签名，与 nodeName 属性的值相等。
            -   Element.dir 用于读写当前元素的文字方向，可能是从左到右（"ltr"），也可能是从右到左（"rtl"）。
            -   Element.accessKey 用于读写分配给当前元素的快捷键。
            -   Element.draggable 返回一个布尔值，表示当前元素是否可拖动。该属性可读写。
            -   Element.lang 返回当前元素的语言设置。该属性可读写。
            -   Element.tabIndex 返回一个整数，表示当前元素在 Tab 键遍历时的顺序。该属性可读写。
            -   Element.title 用来读写当前元素的 HTML 属性 title。该属性通常用来指定，鼠标悬浮时弹出的文字提示框
        -   元素状态的相关属性

            -   Element.hidden 返回一个布尔值，表示当前元素的 hidden 属性，用来控制当前元素是否可见。该属性可读写。
            -   Element.contentEditable，Element.isContentEditable
            -   Element.attributes 返回一个类似数组的对象，成员是当前元素节点的所有属性节点
            -   Element.className，Element.classList  
                className 属性用来读写当前元素节点的 class 属性。它的值是一个字符串，每个 class 之间用空格分割。  
                classList 属性返回一个类似数组的对象，当前元素节点的每个 class 就是这个对象的一个成员。  
                classList 对象有下列方法。
                -   add()：增加一个 class。
                -   remove()：移除一个 class。
                -   contains()：检查当前元素是否包含某个 class。
                -   toggle()：将某个 class 移入或移出当前元素。
                -   item()：返回指定索引位置的 class。
                -   toString()：将 class 的列表转为字符串。
            -   Element.dataset  
                 网页元素可以自定义 data-属性，用来添加数据。  
                 Element.dataset 属性返回一个对象，可以从这 个对象读写 data-属性。  
                 JavaScript 对应的 dataset 属性名，规则如下:
                -   开头的 data-会省略。
                -   如果连词线后面跟了一个英文字母，那么连词线会取消，该字母变成大写。
                -   其他字符不变。
            -   Element.innerHTML 返回一个字符串，等同于该元素包含的所有 HTML 代码
            -   Element.outerHTML 返回一个字符串，表示当前元素节点的所有 HTML 代码，包括该元素本身和所有子元素。
            -   Element.clientHeight，Element.clientWidth
            -   Element.clientLeft  
                 属性等于元素节点左边框（left border）的宽度（单位像素），不包括左侧的 padding 和 margin。
            -   Element.clientTop  
                 等于网页元素顶部边框的宽度（单位像素），其他特点都与 clientLeft 相同
            -   Element.scrollHeight，Element.scrollWidth  
                 Element.scrollHeight 属性返回一个整数值（小数会四舍五入），表示当前元素的  
                总高度（单位像素），包括溢出容器、当前不可见的部分。它包括 padding，但是不包括  
                border、margin 以及水平滚动条的高度（如果有水平滚动条的话），还包括伪元素（::before  
                或::after）的高度。
            -   Element.scrollLeft，Element.scrollTop  
                 Element.scrollLeft 属性表示当前元素的水平滚动条向右侧滚动的像素数量，  
                 Element.scrollTop 属性表示当前元素的垂直滚动条向下滚动的像素数量。  
                 对于那些没有滚动条的网页元素，这两个属性总是等于 0。
            -   Element.offsetParent  
                 回最靠近当前元素的、并且 CSS 的 position 属性不等于 static 的上层元素
            -   Element.offsetHeight，Element.offsetWidth  
                 Element.offsetHeight 属性返回一个整数，表示元素的 CSS 垂直高度（单位像素），  
                 包括元素本身的高度、padding 和 border，以及水平滚动条的高度（如果存在滚动条）。
            -   Element.offsetLeft，Element.offsetTop  
                Element.offsetLeft 返回当前元素左上角相对于 Element.offsetParent 节点的水平位移，  
                Element.offsetTop 返回垂直位移，单位为像素。通常，这两个值是指相对于父节点的位移。

                ```javascript
                //算出元素左上角相对于整张网页的坐标。
                function getElementPosition(e) {
                    var x = 0;
                    var y = 0;
                    while (e !== null) {
                        x += e.offsetLeft;
                        y += e.offsetTop;
                        e = e.offsetParent;
                    }
                    return {x: x, y: y};
                }
                ```

            -   Element.style  
                每个元素节点都有 style 用来读写该元素的行内样式信息
            -   Element.children，Element.childElementCount
            -   Element.firstElementChild，Element.lastElementChild
            -   Element.nextElementSibling，Element.previousElementSibling

    -   实例方法

        -   属性相关的方法
            -   getAttribute()：读取某个属性的值
            -   getAttributeNames()：返回当前元素的所有属性名
            -   setAttribute()：写入属性值
            -   hasAttribute()：某个属性是否存在
            -   hasAttributes()：当前元素是否有属性
            -   removeAttribute()：删除属性
        -   Element.querySelector()
        -   Element.querySelectorAll()
        -   Element.getElementsByClassName()
        -   Element.getElementsByTagName()
        -   Element.closest()  
            接受一个 CSS 选择器作为参数，返回匹配该选择器的、最接近当前节点的一个祖先节点  
            （包括当前节点本身）。如果没有任何节点匹配 CSS 选择器，则返回 null。
        -   Element.matches()  
            返回一个布尔值，表示当前元素是否匹配给定的 CSS 选择器。
        -   事件相关方法  
             以下三个方法与 Element 节点的事件相关。这些方法都继承自 EventTarget 接口。
            -   Element.addEventListener()：添加事件的回调函数
            -   Element.removeEventListener()：移除事件监听函数
            -   Element.dispatchEvent()：触发事件
        -   Element.scrollIntoView()  
             滚动当前元素，进入浏览器的可见区域，类似于设置 window.location.hash 的效果。
        -   Element.getBoundingClientRect()  
             返回一个对象，提供当前元素节点的大小、位置等信息，基本上就是 CSS 盒状模型的所有信息。  
             getBoundingClientRect 方法返回的 rect 对象，具有以下属性（全部为只读）。

                -   x：元素左上角相对于视口的横坐标
                -   y：元素左上角相对于视口的纵坐标
                -   height：元素高度
                -   width：元素宽度
                -   left：元素左上角相对于视口的横坐标，与 x 属性相等
                -   right：元素右边界相对于视口的横坐标（等于 x + width）
                -   top：元素顶部相对于视口的纵坐标，与 y 属性相等
                -   bottom：元素底部相对于视口的纵坐标（等于 y + height）

            由于元素相对于视口（viewport）的位置，会随着页面滚动变化，因此表示位置的四个属性值，  
            都不是固定不变的。如果想得到绝对位置，可以将 left 属性加上 window.scrollX，top 属性  
            加上 window.scrollY。

        -   Element.getClientRects()  
            这个方法主要用于判断行内元素是否换行，以及行内元素的每一行的位置偏移
        -   Element.insertAdjacentElement()  
            在相对于当前元素的指定位置，插入一个新的节点。  
            一共可以接受两个参数，第一个参数是一个字符串，表示插入的位置，第二个参数是将要插入的节点。  
            第一个参数只可以取如下的值。

            -   beforebegin：当前元素之前
            -   afterbegin：当前元素内部的第一个子节点前面
            -   beforeend：当前元素内部的最后一个子节点后面
            -   afterend：当前元素之后

            注意，beforebegin 和 afterend 这两个值，只在当前节点有父节点时才会生效。如果当前节点是  
            由脚本创建的，没有父节点，那么插入会失败。

        -   Element.insertAdjacentHTML()，Element.insertAdjacentText()

            Element.insertAdjacentHTML 用于将一个 HTML 字符串，解析生成 DOM 结构，  
            插入相对于当前节点的指定位置。  
            Element.insertAdjacentText 方法在相对于当前节点的指定位置，插入一个文本节点，  
            用法与 Element.insertAdjacentHTML 方法完全一致

        -   Element.remove()

        -   Element.focus()，Element.blur()
            ```javascript
            //让btn元素获得焦点，并滚动到可见区域。
            function getFocus() {
                document.getElementById('btn').focus({preventScroll: false});
            }
            ```
        -   Element.click()

    -   参考链接
